import XCTest
@testable import SwiftCompilerArguments

class SwiftCompilerArgumentsTests: XCTestCase {
    func testInvariant() {
        let originalArguments = "-frontend -c -primary-file /Users/ainopara/Documents/Projects/SwiftCompilerArguments/Sources/SwiftCompilerArguments/SwiftCompilerArguments.swift -target arm64-apple-ios11.0 -Xllvm -aarch64-use-tbi -enable-objc-interop -sdk /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/SDKs/iPhoneOS11.0.sdk -I /Users/ainopara/Library/Developer/Xcode/DerivedData/SwiftCompilerArguments-gpvtxpjfqribcueuzolpjfulsfnm/Build/Products/Debug-iphoneos -F /Users/ainopara/Library/Developer/Xcode/DerivedData/SwiftCompilerArguments-gpvtxpjfqribcueuzolpjfulsfnm/Build/Products/Debug-iphoneos -F /Applications/Xcode.app/Contents/Developer/Platforms/iPhoneOS.platform/Developer/Library/Frameworks -enable-testing -g -module-cache-path /Users/ainopara/Library/Developer/Xcode/DerivedData/ModuleCache -swift-version 4 -enforce-exclusivity=checked -D SWIFT_PACKAGE -D Xcode -serialize-debugging-options -Xcc -I/Users/ainopara/Library/Developer/Xcode/DerivedData/SwiftCompilerArguments-gpvtxpjfqribcueuzolpjfulsfnm/Build/Intermediates.noindex/SwiftCompilerArguments.build/Debug-iphoneos/SwiftCompilerArguments.build/swift-overrides.hmap -Xcc -I/Users/ainopara/Library/Developer/Xcode/DerivedData/SwiftCompilerArguments-gpvtxpjfqribcueuzolpjfulsfnm/Build/Products/Debug-iphoneos/include -Xcc -I/Users/ainopara/Library/Developer/Xcode/DerivedData/SwiftCompilerArguments-gpvtxpjfqribcueuzolpjfulsfnm/Build/Intermediates.noindex/SwiftCompilerArguments.build/Debug-iphoneos/SwiftCompilerArguments.build/DerivedSources/arm64 -Xcc -I/Users/ainopara/Library/Developer/Xcode/DerivedData/SwiftCompilerArguments-gpvtxpjfqribcueuzolpjfulsfnm/Build/Intermediates.noindex/SwiftCompilerArguments.build/Debug-iphoneos/SwiftCompilerArguments.build/DerivedSources -Xcc -working-directory/Users/ainopara/Documents/Projects/SwiftCompilerArguments -emit-module-doc-path /Users/ainopara/Library/Developer/Xcode/DerivedData/SwiftCompilerArguments-gpvtxpjfqribcueuzolpjfulsfnm/Build/Intermediates.noindex/SwiftCompilerArguments.build/Debug-iphoneos/SwiftCompilerArguments.build/Objects-normal/arm64/SwiftCompilerArguments~partial.swiftdoc -serialize-diagnostics-path /Users/ainopara/Library/Developer/Xcode/DerivedData/SwiftCompilerArguments-gpvtxpjfqribcueuzolpjfulsfnm/Build/Intermediates.noindex/SwiftCompilerArguments.build/Debug-iphoneos/SwiftCompilerArguments.build/Objects-normal/arm64/SwiftCompilerArguments.dia -Onone -parse-as-library -module-name SwiftCompilerArguments -emit-module-path /Users/ainopara/Library/Developer/Xcode/DerivedData/SwiftCompilerArguments-gpvtxpjfqribcueuzolpjfulsfnm/Build/Intermediates.noindex/SwiftCompilerArguments.build/Debug-iphoneos/SwiftCompilerArguments.build/Objects-normal/arm64/SwiftCompilerArguments~partial.swiftmodule -emit-dependencies-path /Users/ainopara/Library/Developer/Xcode/DerivedData/SwiftCompilerArguments-gpvtxpjfqribcueuzolpjfulsfnm/Build/Intermediates.noindex/SwiftCompilerArguments.build/Debug-iphoneos/SwiftCompilerArguments.build/Objects-normal/arm64/SwiftCompilerArguments.d -emit-reference-dependencies-path /Users/ainopara/Library/Developer/Xcode/DerivedData/SwiftCompilerArguments-gpvtxpjfqribcueuzolpjfulsfnm/Build/Intermediates.noindex/SwiftCompilerArguments.build/Debug-iphoneos/SwiftCompilerArguments.build/Objects-normal/arm64/SwiftCompilerArguments.swiftdeps -o /Users/ainopara/Library/Developer/Xcode/DerivedData/SwiftCompilerArguments-gpvtxpjfqribcueuzolpjfulsfnm/Build/Intermediates.noindex/SwiftCompilerArguments.build/Debug-iphoneos/SwiftCompilerArguments.build/Objects-normal/arm64/SwiftCompilerArguments.o -embed-bitcode-marker -index-store-path /Users/ainopara/Library/Developer/Xcode/DerivedData/SwiftCompilerArguments-gpvtxpjfqribcueuzolpjfulsfnm/Index/DataStore -index-system-modules".split(separator: " ").map(String.init)

        let swiftcArguments = SwiftCompilerArguments(arguments: originalArguments)
        let dumpedArguments = SwiftCompilerArguments(arguments: swiftcArguments.arguments())
        XCTAssertEqual(swiftcArguments.arguments(), dumpedArguments.arguments())
    }


    static var allTests = [
        ("testInvariant", testInvariant),
    ]
}
